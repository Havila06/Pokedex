
<div class="mt-16 md:mx-auto md:px-0 mx-6 md:w-2/3 rounded border border-gray-200 flex flex-col md:flex-row ">

  <div class="w-1/3 md:flex hidden items-center justify-center bg-gray-200">
    <img
      [src]="pokemonPicture.value"
      class="img-fluid rounded-start"
    />
  </div>
<div class="md:w-2/3 h-full">
  <form (ngSubmit)="onSubmit()"
  [formGroup]="form" class="flex px-8 py-6 flex-col space-y-1">
    <h4 class="text-2xl md:text-start text-center mb-6 text-gray-700 font-bold">Ajouter un nouveau Pokémon</h4>
    <div class="border-b border-gray-200 py-2">
      <div class="flex flex-row items-center">
        <h5 class="w-1/3 text-gray-700 font-medium">Nom:</h5>
        <input
          formControlName="name"
          type="text"
          placeholder="Nom du Pokémon"
          [ngClass]="pokemonName.invalid && pokemonName.dirty ? 'border-red-500 focus:border-red-500 focus:ring-2 focus:ring-red-200 focus:outline-none' : 'border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none'"
          class="h-11 w-2/3 px-3 text-gray-700 bg-gray-50 font-medium rounded text-sm border"
        />
      </div>
      <div class="flex flex-row items-start">
        <div class="w-1/3"></div>
        <div class="w-2/3 space-y-1 mt-1">
          @if(pokemonName.dirty) {
            @if (pokemonName.hasError('required')) {
              <div class="text-xs text-red-500">Ce champ est requis.</div>
            }

            @if (pokemonName.hasError('minlength')) {
              <div class="text-xs text-red-500">
                Veuillez saisir un nom plus long. (Minimum :
                {{ pokemonName.getError('minlength')?.requiredLength }} caractères)
              </div>
            }

            @if (pokemonName.hasError('maxlength')) {
              <div class="text-xs text-red-500">
                Veuillez saisir un nom plus court. (Maximum :
                {{ pokemonName.getError('maxlength')?.requiredLength }} caractères)
              </div>
            }

            @if (pokemonName.hasError('pattern')) {
              <div class="text-xs text-red-500">Veuillez saisir uniquement des lettres.</div>
            }
          }
        </div>
      </div>

    </div>
    <div class="border-b border-gray-200 py-2">
      <div class="flex flex-row items-center">
        <h5 class="w-1/3 text-gray-700 font-medium">Image:</h5>
        <input
          formControlName="picture"
          type="text"
          placeholder="URL de l'image du Pokémon"
          [ngClass]="pokemonPicture.invalid && pokemonPicture.dirty ? 'border-red-500 focus:border-red-500 focus:ring-2 focus:ring-red-200 focus:outline-none' : 'border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none'"
          class="h-11 w-2/3 px-3 text-gray-700 bg-gray-50 font-medium rounded text-sm border"
        />
      </div>
      <div class="flex flex-row items-start">
        <div class="w-1/3"></div>
        <div class="w-2/3 space-y-1 mt-1">
          @if(pokemonPicture.dirty) {
            @if (pokemonPicture.hasError('required')) {
              <div class="text-xs text-red-500">Ce champ est requis.</div>
            }
          }
        </div>
      </div>
    </div>

    <div class="flex flex-row items-center border-b border-gray-200 py-2">
      <h5 class="w-1/3 text-gray-700 font-medium">Points de vie:</h5>
      <div class="w-2/3 flex flex-row items-center">
        <button type="button"
        (click)="decrementLife()"
        class="w-11 h-11 flex items-center justify-center bg-blue-200 rounded-l"
        [disabled]="pokemonLife.value <= POKEMON_RULES().MIN_LIFE">
          -
        </button>
        <input
          formControlName="life"
          type="number"
          class="h-11 w-full text-gray-700 font-medium text-center bg-gray-50 border border-gray-300 text-sm focus:ring-blue-500 focus:border-blue-500"

        />
        <button type="button"
        (click)="incrementLife()"
        class="w-11 h-11 flex items-center justify-center bg-blue-200 rounded-r"
        [disabled]="pokemonLife.value >= POKEMON_RULES().MAX_LIFE">
          +
        </button>
      </div>
    </div>

    <div class="flex flex-row items-center border-b border-gray-200 py-2">
      <h5 class="w-1/3 text-gray-700 font-medium">Dégâts:</h5>
      <div class="w-2/3 flex flex-row items-center">
        <button type="button"
        (click)="decrementDamage()"
        class="w-11 h-11 flex items-center justify-center bg-blue-200 rounded-l"
        [disabled]="pokemonDamage.value <= POKEMON_RULES().MIN_DAMAGE">
          -
        </button>
        <input
          formControlName="damage"
          type="number"
          class="h-11 w-full text-gray-700 font-medium text-center bg-gray-50 border border-gray-300 text-sm focus:ring-blue-500 focus:border-blue-500"
          readonly
        />
        <button type="button"
        (click)="incrementDamage()"
        class="w-11 h-11 flex items-center justify-center bg-blue-200 rounded-r"
        [disabled]="pokemonDamage.value >= POKEMON_RULES().MAX_DAMAGE">
          +
        </button>
      </div>
    </div>

    <div class="flex flex-row items-center border-b border-gray-200 py-2">
      <h5 class="w-1/3 text-gray-700 font-medium">Types:</h5>
      <div class="w-2/3">
        @for(type of pokemonTypeList.controls; track type; let
        index = $index) {
          <button
            (click)="pokemonTypeList.removeAt(index)"
            [style.backgroundColor]="getPokemonColor(type.value)"
            [style.color]="type.value === 'Electrik' ? 'black' : 'white'"
            class="mb-2 mr-3 font-semibold px-3 py-1 rounded-md"
          >
            {{ type.value }} <span class=" ml-1 badge">x</span>
          </button>
        }
        @if (pokemonTypeList.hasError('required')) {
          <div class="text-xs mt-1 text-red-500">Veuillez sélectionner au moins un type pour un Pokémon.</div>
        }

        @if (pokemonTypeList.hasError('maxlength')) {
          <div class="text-xs mt-1 text-red-500">Veuillez sélectionner
            au maximun {{ pokemonTypeList.getError('maxlength').requiredLength }} types pour un Pokémon.</div>
        }
        <div class="mt-5 grid grid-cols-2 md:grid-cols-3">
          @for(type of pokemonService.getPokemonTypeList(); track
          type) {
          <div class="">
            <div class="mb-2 flex items-center space-x-2">
              <input
                class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm focus:ring-blue-200 focus-ring-2"
                id="default-checkbox" type="checkbox"
                #checkbox
                (change)="
                  onPokemonTypeChange(type, checkbox.checked)
                "
                [checked]="isPokemonTypeSelected(type)"
                [value]="type"
                [id]="type"
              />
              <label class="text-gray-700" [for]="type">
                {{ type }}
              </label>
            </div>
          </div>
          }
        </div>

      </div>
    </div>
    <div class="flex flex-row mt-4 space-x-4">
      <button type="button" routerLink="/pokemons" class="flex-1 py-2 bg-orange-500 text-white font-medium rounded shadow-md hover:bg-orange-600 transition duration-200">
        Annuler
      </button>
      <button
      type="submit"
      [disabled]="form.invalid"
      [class.bg-green-300]="form.invalid"
      [class.bg-green-500]="form.valid"
      class="flex-1 py-2 text-white font-medium rounded shadow-md hover:bg-green-600 transition duration-200">
        Sauvegarder 
      </button>
    </div>
  </form>
</div>
</div>








